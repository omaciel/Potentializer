<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Potentializer</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            padding: 20px;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 30px;
        }

        .grid-item {
            border: 2px solid #ccc;
            padding: 10px;
            text-align: center;
            min-height: 150px;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .container {
            max-width: 100%;
            overflow-x: auto;
        }

        table {
            width: 100%;
            table-layout: fixed; /* Ensure consistent column widths */
        }

        th, td {
            padding: 10px;
            text-align: center;
            white-space: nowrap;
            vertical-align: middle; /* Ensure vertical alignment */
        }

        th {
            width: 150px; /* Consistent width for table headers */
        }

        .performance-col {
            width: 200px; /* Width for Performance column */
        }

        .talent-col {
            width: 200px; /* Width for Talent column */
        }

        .movement-col {
            width: 150px; /* Width for Movement column */
        }

        .score-col, .box-col, .actions-col .del-col {
            width: 100px; /* Width for smaller columns */
        }

        select {
            width: 100%; /* Ensure dropdown takes up full cell width */
        }

        #box1 {
            background-color: #C4D7FF; /* Light blue */
        }
        #box2 {
            background-color: #C4D7FF; /* Light blue */
        }

        #box3 {
            background-color: #96CEB4; /* Light green */
        }

        #box4 {
            background-color: #96CEB4; /* Light green */
        }

        #box5 {
            background-color: #96CEB4; /* Light green */
        }

        #box6 {
            background-color: #96CEB4; /* Light green */
        }

        #box7 {
            background-color: #FEFFA7; /* Light yellow */
        }

        #box8 {
            background-color: #FFBF61; /* Light orange */
        }

        #box9 {
            background-color: #F95454; /* Light red */
        }

    </style>
</head>
<body>

    <div class="container">
        <h1 class="text-center">Potentializer</h1>

        <!-- 3x3 grid for the 9 boxes -->
        <div class="grid-container">
            <div class="grid-item" id="box7">Box 7 (Potential Gems)</div>
            <div class="grid-item" id="box2">Box 2 (High Potentials)</div>
            <div class="grid-item" id="box1">Box 1 (Stars)</div>
            <div class="grid-item" id="box8">Box 8 (Inconsistent Performers)</div>
            <div class="grid-item" id="box4">Box 4 (Core Players)</div>
            <div class="grid-item" id="box3">Box 3 (High Performers)</div>
            <div class="grid-item" id="box9">Box 9 (Underperformers)</div>
            <div class="grid-item" id="box6">Box 6 (Backups)</div>
            <div class="grid-item" id="box5">Box 5 (Consistent Performers)</div>
        </div>

        <button id="addIndividualBtn" class="btn btn-primary mb-3">Add Individual</button>

        <table class="table table-striped" id="individualTable">
            <thead>
                <tr>
                    <th rowspan="2">Individual</th>
                    <th colspan="2" class="performance-col">Performance</th>
                    <th colspan="2" class="talent-col">Talent</th>
                    <th rowspan="2" class="movement-col">Movement</th>
                    <th rowspan="2" class="actions-col">Actions</th>
                    <th rowspan="2" class="score-col">Score</th>
                    <th rowspan="2" class="box-col">Box</th>
                </tr>
                <tr>
                    <th>What</th>
                    <th>How</th>
                    <th>Growth</th>
                    <th>Leadership</th>
                </tr>
            </thead>
            <tbody>
                <!-- Rows for individuals will be dynamically added here -->
            </tbody>
        </table>
    </div>

    <script>
        let individualCount = 0;
        const individualBoxMapping = {}; // To track which box each individual is in

        // Add individual function
        document.getElementById('addIndividualBtn').addEventListener('click', function() {
            const tableBody = document.querySelector('#individualTable tbody');
            individualCount++;
            
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td rowspan="2">Individual ${individualCount}</td>
                <td>${createDropdown('performanceWhat', 'Performance')}</td>
                <td>${createDropdown('performanceHow', 'Performance')}</td>
                <td>${createDropdown('talentGrowth', 'FutureTalent')}</td>
                <td>${createDropdown('talentLeadership', 'FutureTalent')}</td>
                <td rowspan="2">${createDropdown('movementReadiness', 'Movement')}</td>
                <td rowspan="2">${createDropdown('talentActions', 'TalentActions')}</td>
                <td rowspan="2" class="totalScore">0</td>
                <td rowspan="2" class="assignedBox">-</td>
                <td rowspan="2"><button class="btn btn-danger btn-sm removeBtn">Remove</button></td>
            `;
            const emptyRow = document.createElement('tr');
            tableBody.appendChild(newRow);
            tableBody.appendChild(emptyRow);

            // Add event listener to update score and box when dropdowns change
            newRow.querySelectorAll('select').forEach(select => {
                select.addEventListener('change', calculateScore);
            });

            // Add event listener to remove row
            newRow.querySelector('.removeBtn').addEventListener('click', function() {
                removeIndividualFromBox(newRow.cells[0].innerText); // Remove individual from the box
                newRow.remove();
            });
        });

        // Create dropdown HTML based on the type (Performance, FutureTalent, Movement, TalentActions)
        function createDropdown(questionType, category) {
            let options = '';

            switch (category) {
                case 'Performance':
                    options = `
                        <option value="" selected disabled></option>
                        <option value="4">Surpasses Expectations</option>
                        <option value="3">Meets Expectations</option>
                        <option value="2"></option>
                        <option value="1">Meets Some Expectations</option>
                        <option value="-1">Does Not Meet Expectations</option>
                    `;
                    break;
                case 'FutureTalent':
                    options = `
                        <option value="" selected disabled></option>
                        <option value="4">Always/Most of the Time</option>
                        <option value="1">Sometimes</option>
                        <option value="-1">Never</option>
                    `;
                    break;
                case 'Movement':
                    options = `
                        <option value="" selected disabled></option>
                        <option value="4">Ready for promotion</option>
                        <option value="1">Continue growing in current role</option>
                        <option value="-1">Not well placed</option>
                    `;
                    break;
                case 'TalentActions':
                    options = `
                        <option value="" selected disabled></option>
                        <option value="4">Growth/Ready for lateral move or promotion</option>
                        <option value="2">Rewards</option>
                        <option value="1">Development</option>
                        <option value="-1">Growth/Not well placed</option>
                    `;
                    break;
            }

            return `<select class="form-select ${questionType}">${options}</select>`;
        }

        // Calculate the total score and assigned box
        function calculateScore() {
            const row = this.closest('tr');
            let totalScore = 0;

            // Sum up scores for the row and the next row
            row.querySelectorAll('select').forEach(select => {
                totalScore += parseInt(select.value);
            });

            // Update total score
            row.querySelector('.totalScore').innerText = totalScore;

            // Determine which box to assign
            const assignedBox = row.querySelector('.assignedBox');
            const boxNumber = getBox(totalScore);
            assignedBox.innerText = boxNumber;

            // Move individual to the corresponding grid box
            moveToBox(boxNumber, row.cells[0].innerText);
        }

        // Determine which box based on the total score
        function getBox(totalScore) {
            if (totalScore >= 22) return '1 (Stars)';
            if (totalScore >= 19) return '2 (High Potentials)';
            if (totalScore >= 16) return '3 (High Performers)';
            if (totalScore >= 13) return '4 (Core Players)';
            if (totalScore >= 10) return '5 (Consistent Performers)';
            if (totalScore >= 7) return '6 (Up or Out Grinders)';
            if (totalScore >= 4) return '7 (Potential Gems)';
            if (totalScore >= 1) return '8 (Inconsistent Performers)';
            return '9 (Underperformers)';
        }

        // Move the individual to the appropriate grid box
        function moveToBox(boxNumber, individualName) {
            const boxId = `box${boxNumber[0]}`; // Extract the box number from the text
            const currentBoxId = individualBoxMapping[individualName]; // Get the current box of the individual

            // If the individual is already in a box, remove them from the previous box
            if (currentBoxId) {
                const currentBoxElement = document.getElementById(currentBoxId);
                const individualsInBox = currentBoxElement.querySelectorAll('p');
                individualsInBox.forEach(p => {
                    if (p.innerText === individualName) {
                        p.remove(); // Remove the individual from the previous box
                    }
                });
            }

            // Add the individual to the new box
            const boxElement = document.getElementById(boxId);
            boxElement.innerHTML += `<p>${individualName}</p>`;

            // Update the mapping to track the individual's current box
            individualBoxMapping[individualName] = boxId;
        }

        // Remove the individual from the grid when their row is deleted
        function removeIndividualFromBox(individualName) {
            const currentBoxId = individualBoxMapping[individualName];

            if (currentBoxId) {
                const currentBoxElement = document.getElementById(currentBoxId);
                const individualsInBox = currentBoxElement.querySelectorAll('p');
                individualsInBox.forEach(p => {
                    if (p.innerText === individualName) {
                        p.remove(); // Remove the individual from the current box
                    }
                });

                // Remove the individual from the mapping
                delete individualBoxMapping[individualName];
            }
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>